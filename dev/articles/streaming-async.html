<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Streaming and async APIs • ellmer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Streaming and async APIs">
<meta name="robots" content="noindex">
<script defer data-domain="ellmer.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ellmer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/ellmer.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/prompt-design.html">Prompt design</a></li>
    <li><a class="dropdown-item" href="../articles/streaming-async.html">Streaming and async APIs</a></li>
    <li><a class="dropdown-item" href="../articles/structured-data.html">Structured data</a></li>
    <li><a class="dropdown-item" href="../articles/tool-calling.html">Tool/function calling</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidyverse/ellmer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Streaming and async APIs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/ellmer/blob/main/vignettes/streaming-async.Rmd" class="external-link"><code>vignettes/streaming-async.Rmd</code></a></small>
      <div class="d-none name"><code>streaming-async.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="streaming-results">Streaming results<a class="anchor" aria-label="anchor" href="#streaming-results"></a>
</h3>
<p>The <code>chat()</code> method does not return any results until the
entire response is received. (It can <em>print</em> the streaming
results to the console but it <em>returns</em> the result only when the
response is complete.)</p>
<p>If you want to process the response as it arrives, you can use the
<code>stream()</code> method. This is useful when you want to send the
response, in realtime, somewhere other than the R console (e.g., to a
file, an HTTP response, or a Shiny chat window), or when you want to
manipulate the response before displaying it without giving up the
immediacy of streaming.</p>
<p>With the <code>stream()</code> method, which returns a <a href="https://coro.r-lib.org/" class="external-link">coro</a> <a href="https://coro.r-lib.org/articles/generator.html" class="external-link">generator</a>, you
can process the response by looping over it as it arrives.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stream</span> <span class="op">&lt;-</span> <span class="va">chat</span><span class="op">$</span><span class="fu">stream</span><span class="op">(</span><span class="st">"What are some common uses of R?"</span><span class="op">)</span></span>
<span><span class="fu">coro</span><span class="fu">::</span><span class="fu"><a href="https://coro.r-lib.org/reference/collect.html" class="external-link">loop</a></span><span class="op">(</span><span class="kw">for</span> <span class="op">(</span><span class="va">chunk</span> <span class="kw">in</span> <span class="va">stream</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">chunk</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;  R IS COMMONLY USED FOR:</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;  1. **STATISTICAL ANALYSIS**: PERFORMING COMPLEX STATISTICAL TESTS AND ANALYSES.</span></span>
<span><span class="co">#&gt;  2. **DATA VISUALIZATION**: CREATING GRAPHS, CHARTS, AND PLOTS USING PACKAGES LIKE  GGPLOT2.</span></span>
<span><span class="co">#&gt;  3. **DATA MANIPULATION**: CLEANING AND TRANSFORMING DATA WITH PACKAGES LIKE DPLYR AND TIDYR.</span></span>
<span><span class="co">#&gt;  4. **MACHINE LEARNING**: BUILDING PREDICTIVE MODELS WITH LIBRARIES LIKE CARET AND #&gt;  RANDOMFOREST.</span></span>
<span><span class="co">#&gt;  5. **BIOINFORMATICS**: ANALYZING BIOLOGICAL DATA AND GENOMIC STUDIES.</span></span>
<span><span class="co">#&gt;  6. **ECONOMETRICS**: PERFORMING ECONOMIC DATA ANALYSIS AND MODELING.</span></span>
<span><span class="co">#&gt;  7. **REPORTING**: GENERATING DYNAMIC REPORTS AND DASHBOARDS WITH R MARKDOWN.</span></span>
<span><span class="co">#&gt;  8. **TIME SERIES ANALYSIS**: ANALYZING TEMPORAL DATA AND FORECASTING.</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;  THESE USES MAKE R A POWERFUL TOOL FOR DATA SCIENTISTS, STATISTICIANS, AND RESEARCHERS.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="async-usage">Async usage<a class="anchor" aria-label="anchor" href="#async-usage"></a>
</h2>
<p>ellmer also supports async usage. This is useful when you want to run
multiple, concurrent chat sessions. This is particularly important for
Shiny applications where using the methods described above would block
the Shiny app for other users for the duration of each response.</p>
<p>To use async chat, call
<code>chat_async()</code>/<code>stream_async()</code> instead of
<code>chat()</code>/<code>stream()</code>. The <code>_async</code>
variants take the same arguments for construction but return a promise
instead of the actual response.</p>
<p>Remember that chat objects are stateful; they preserve the
conversation history as you interact with it. This means that it doesn’t
make sense to issue multiple, concurrent chat/stream operations on the
same chat object because the conversation history can become corrupted
with interleaved conversation fragments. If you need to run concurrent
chat sessions, create multiple chat objects.</p>
<div class="section level3">
<h3 id="asynchronous-chat">Asynchronous chat<a class="anchor" aria-label="anchor" href="#asynchronous-chat"></a>
</h3>
<p>For asynchronous, non-streaming chat, you’d use the
<code>chat()</code> method as before, but handle the result as a promise
instead of a string.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/promises/" class="external-link">promises</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">chat</span><span class="op">$</span><span class="fu">chat_async</span><span class="op">(</span><span class="st">"How's your day going?"</span><span class="op">)</span> <span class="op"><a href="https://rstudio.github.io/promises/reference/pipes.html" class="external-link">%...&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; I'm just a computer program, so I don't have feelings, but I'm here to help you with any questions you have.</span></span></code></pre></div>
<div class="section level4">
<h4 id="shiny-example">Shiny example<a class="anchor" aria-label="anchor" href="#shiny-example"></a>
</h4>
<p>To add an asynchronous chat interface in your Shiny application, we
recommend using <a href="https://posit-dev.github.io/shinychat/" class="external-link">the
shinychat package</a>.</p>
<p>The simplest approach is to use shinychat’s Shiny module to add a
chat UI to your app—similar to the app created by
<code><a href="../reference/live_console.html">live_browser()</a></code>—using the
<code><a href="https://jcheng5.github.io/shinychat/reference/chat_app.html" class="external-link">shinychat::chat_mod_ui()</a></code> and
<code><a href="https://jcheng5.github.io/shinychat/reference/chat_app.html" class="external-link">shinychat::chat_mod_server()</a></code> functions. These module
functions connect an <code><a href="../reference/Chat.html">ellmer::Chat</a></code> object to
<code><a href="https://jcheng5.github.io/shinychat/reference/chat_ui.html" class="external-link">shinychat::chat_ui()</a></code> and handle non-blocking asynchronous
chat interactions automatically.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/posit-dev/shinychat" class="external-link">shinychat</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">bslib</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/page_fillable.html" class="external-link">page_fillable</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://jcheng5.github.io/shinychat/reference/chat_app.html" class="external-link">chat_mod_ui</a></span><span class="op">(</span><span class="st">"chat"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">chat</span> <span class="op">&lt;-</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="../reference/chat_openai.html">chat_openai</a></span><span class="op">(</span></span>
<span>    system_prompt <span class="op">=</span> <span class="st">"You're a trickster who answers in riddles"</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"gpt-4.1-nano"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://jcheng5.github.io/shinychat/reference/chat_app.html" class="external-link">chat_mod_server</a></span><span class="op">(</span><span class="st">"chat"</span>, <span class="va">chat</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></span></code></pre></div>
<p>For fully custom streaming applications with a custom or no chat
interface, you can use <code><a href="https://jcheng5.github.io/shinychat/reference/markdown_stream.html" class="external-link">shinychat::markdown_stream()</a></code> to
stream responses into a Shiny app. This is particularly useful for
creating interactive chat applications where you want to display
responses as they are generated.</p>
<p>The following Shiny app demonstrates <code><a href="https://jcheng5.github.io/shinychat/reference/markdown_stream.html" class="external-link">markdown_stream()</a></code>
and uses both <code>$stream_async()</code> and
<code>$chat_async()</code> to stream a story from an OpenAI model. In
the app, we ask the user for a prompt to generate a story and then
stream the story into the UI. Then we follow up by asking the model for
a story title and we use the response to update the card title.</p>
<p>This example also highlights the difference between streaming and
non-streaming chat. Use <code>$stream_async()</code> with Shiny outputs
that are designed to work with generators, like
<code><a href="https://jcheng5.github.io/shinychat/reference/markdown_stream.html" class="external-link">shinychat::markdown_stream()</a></code> and
<code><a href="https://jcheng5.github.io/shinychat/reference/chat_append.html" class="external-link">shinychat::chat_append()</a></code>. Use <code>$chat_async()</code>
when you want the text response from the model, for example the title of
the story.</p>
<p>Also note that in most ellmer-powered Shiny apps, it’s best to wrap
the chat interaction in a <code><a href="https://rdrr.io/pkg/shiny/man/ExtendedTask.html" class="external-link">shiny::ExtendedTask</a></code> to avoid
blocking the rest of the app while the chat is being generated. You can
learn about <code>ExtendedTask</code> in Shiny’s <a href="https://shiny.posit.co/r/articles/improve/nonblocking/" class="external-link"><em>Non-blocking
operations</em> article</a>.</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/bslib/" class="external-link">bslib</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ellmer.tidyverse.org">ellmer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/promises/" class="external-link">promises</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/posit-dev/shinychat" class="external-link">shinychat</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rstudio.github.io/bslib/reference/page_sidebar.html" class="external-link">page_sidebar</a></span><span class="op">(</span></span>
<span>  title <span class="op">=</span> <span class="st">"Interactive chat with async"</span>,</span>
<span>  sidebar <span class="op">=</span> <span class="fu"><a href="https://rstudio.github.io/bslib/reference/sidebar.html" class="external-link">sidebar</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textAreaInput.html" class="external-link">textAreaInput</a></span><span class="op">(</span><span class="st">"user_query"</span>, <span class="st">"Tell me a story about..."</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rstudio.github.io/bslib/reference/input_task_button.html" class="external-link">input_task_button</a></span><span class="op">(</span><span class="st">"ask_chat"</span>, label <span class="op">=</span> <span class="st">"Generate a story"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rstudio.github.io/bslib/reference/card.html" class="external-link">card</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/bslib/reference/card_body.html" class="external-link">card_header</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">textOutput</a></span><span class="op">(</span><span class="st">"story_title"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu">shinychat</span><span class="fu">::</span><span class="fu"><a href="https://jcheng5.github.io/shinychat/reference/output_markdown_stream.html" class="external-link">output_markdown_stream</a></span><span class="op">(</span><span class="st">"response"</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">chat_task</span> <span class="op">&lt;-</span> <span class="va"><a href="https://rdrr.io/pkg/shiny/man/ExtendedTask.html" class="external-link">ExtendedTask</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">user_query</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># We're using an Extended Task for chat completions to avoid blocking the</span></span>
<span>    <span class="co"># app. We also start the chat fresh each time, because the UI is not a</span></span>
<span>    <span class="co"># multi-turn conversation.</span></span>
<span>    <span class="va">chat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chat_openai.html">chat_openai</a></span><span class="op">(</span></span>
<span>      system_prompt <span class="op">=</span> <span class="st">"You are a rambling chatbot who likes to tell stories but gets distracted easily."</span>,</span>
<span>      model <span class="op">=</span> <span class="st">"gpt-4.1-nano"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Stream the chat completion into the markdown stream. `markdown_stream()`</span></span>
<span>    <span class="co"># returns a promise onto which we'll chain the follow-up task of providing</span></span>
<span>    <span class="co"># a story title.</span></span>
<span>    <span class="va">stream</span> <span class="op">&lt;-</span> <span class="va">chat</span><span class="op">$</span><span class="fu">stream_async</span><span class="op">(</span><span class="va">user_query</span><span class="op">)</span></span>
<span>    <span class="va">stream_res</span> <span class="op">&lt;-</span> <span class="fu">shinychat</span><span class="fu">::</span><span class="fu"><a href="https://jcheng5.github.io/shinychat/reference/markdown_stream.html" class="external-link">markdown_stream</a></span><span class="op">(</span><span class="st">"response"</span>, <span class="va">stream</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Follow up by asking the LLM to provide a title for the story that we</span></span>
<span>    <span class="co"># return from the task.</span></span>
<span>    <span class="va">stream_res</span><span class="op">$</span><span class="fu">then</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">chat</span><span class="op">$</span><span class="fu">chat_async</span><span class="op">(</span></span>
<span>        <span class="st">"What is the title of the story? Reply with only the title and nothing else."</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/bslib/reference/bind_task_button.html" class="external-link">bind_task_button</a></span><span class="op">(</span><span class="va">chat_task</span>, <span class="st">"ask_chat"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">ask_chat</span>, <span class="op">{</span></span>
<span>    <span class="va">chat_task</span><span class="op">$</span><span class="fu">invoke</span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">user_query</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observe.html" class="external-link">observe</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="co"># Update the card title during generation and once complete</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span></span>
<span>      <span class="va">chat_task</span><span class="op">$</span><span class="fu">status</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      success <span class="op">=</span> <span class="fu">story_title</span><span class="op">(</span><span class="va">chat_task</span><span class="op">$</span><span class="fu">result</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      running <span class="op">=</span> <span class="fu">story_title</span><span class="op">(</span><span class="st">"Generating your story..."</span><span class="op">)</span>,</span>
<span>      error <span class="op">=</span> <span class="fu">story_title</span><span class="op">(</span><span class="st">"An error occurred while generating your story."</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">story_title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveVal.html" class="external-link">reactiveVal</a></span><span class="op">(</span><span class="st">"Your story will appear here!"</span><span class="op">)</span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">story_title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="fu">story_title</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span>ui <span class="op">=</span> <span class="va">ui</span>, server <span class="op">=</span> <span class="va">server</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="asynchronous-streaming">Asynchronous streaming<a class="anchor" aria-label="anchor" href="#asynchronous-streaming"></a>
</h3>
<p>For asynchronous streaming, you’d use the <code>stream()</code>
method as before, but the result is an <a href="https://coro.r-lib.org/reference/async_generator.html" class="external-link">async
generator</a> from the <a href="https://coro.r-lib.org/" class="external-link">coro
package</a>. This is the same as a regular <a href="https://coro.r-lib.org/articles/generator.html" class="external-link">generator</a>,
except that instead of giving you strings, it gives you promises that
resolve to strings.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stream</span> <span class="op">&lt;-</span> <span class="va">chat</span><span class="op">$</span><span class="fu">stream_async</span><span class="op">(</span><span class="st">"What are some common uses of R?"</span><span class="op">)</span></span>
<span><span class="fu">coro</span><span class="fu">::</span><span class="fu"><a href="https://coro.r-lib.org/reference/async.html" class="external-link">async</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">chunk</span> <span class="kw">in</span> <span class="fu">await_each</span><span class="op">(</span><span class="va">stream</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">chunk</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  R IS COMMONLY USED FOR:</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;  1. **STATISTICAL ANALYSIS**: PERFORMING VARIOUS STATISTICAL TESTS AND MODELS.</span></span>
<span><span class="co">#&gt;  2. **DATA VISUALIZATION**: CREATING PLOTS AND GRAPHS TO VISUALIZE DATA.</span></span>
<span><span class="co">#&gt;  3. **DATA MANIPULATION**: CLEANING AND TRANSFORMING DATA WITH PACKAGES LIKE DPLYR.</span></span>
<span><span class="co">#&gt;  4. **MACHINE LEARNING**: BUILDING PREDICTIVE MODELS AND ALGORITHMS.</span></span>
<span><span class="co">#&gt;  5. **BIOINFORMATICS**: ANALYZING BIOLOGICAL DATA, ESPECIALLY IN GENOMICS.</span></span>
<span><span class="co">#&gt;  6. **TIME SERIES ANALYSIS**: ANALYZING TEMPORAL DATA FOR TRENDS AND FORECASTS.</span></span>
<span><span class="co">#&gt;  7. **REPORT GENERATION**: CREATING DYNAMIC REPORTS WITH R MARKDOWN.</span></span>
<span><span class="co">#&gt;  8. **GEOSPATIAL ANALYSIS**: MAPPING AND ANALYZING GEOGRAPHIC DATA.</span></span></code></pre></div>
<p>Async generators are very advanced and require a good understanding
of asynchronous programming in R. They are also the only way to present
streaming results in Shiny without blocking other users. Fortunately,
Shiny will soon have chat components that will make this easier, where
you’ll simply hand the result of <code>stream_async()</code> to a chat
output.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, Joe Cheng, Aaron Jacobs, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

  </div></footer>
</body>
</html>
